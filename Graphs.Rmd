---
title: "Graphs"
author: "Aidan Dold"
date: "2025-10-13"
output: html_document
---

```{r}
library(dplyr)
library(ggplot2)
library(tidyr)
```


```{r}
data %>%
  count(winner, name = "total_wins") %>%
  ggplot(aes(x = reorder(winner, -total_wins), y = total_wins)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Total Wins by Team",
       x = "Team",
       y = "Number of Wins") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
# Combine all team appearances into one long list
all_teams <- data %>%
  select(team_home, team_away) %>%
  tidyr::pivot_longer(cols = everything(), values_to = "team")

# Count total games played by each team
games_played <- all_teams %>%
  count(team, name = "games_played")

# Count total wins by each team
wins <- data %>%
  count(winner, name = "wins") %>%
  rename(team = winner)

# Join wins and games played
win_pct <- full_join(games_played, wins, by = "team") %>%
  mutate(wins = replace_na(wins, 0),
         win_pct = wins / games_played)

# Plot winning percentage
ggplot(win_pct, aes(x = reorder(team, -win_pct), y = win_pct, fill = win_pct)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "red", high = "green") +
  labs(title = "Winning Percentage by Team",
       x = "Team",
       y = "Winning Percentage",
       fill = "Win %") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```



```{r}
# Count total games played at each stadium
games_played <- data %>%
  count(stadium, name = "games_played")

# Count total wins by stadium (how many games were won by the home team or any winner there)
wins <- data %>%
  group_by(stadium) %>%
  summarise(wins = n())  # every game played at stadium counts as a win for that stadium

# Calculate winning percentage (which will be 1 here because every game is played at one stadium)
# But if you want winning percentages by stadium for a specific team or condition, please clarify.

# For simplicity, let's just calculate the win rate of the home team per stadium if you have a `home_team` column:

if ("team_home" %in% names(data)) {
  home_wins <- data %>%
    mutate(home_win = ifelse(winner == team_home, 1, 0)) %>%
    group_by(stadium) %>%
    summarise(home_wins = sum(home_win),
              games_played = n(),
              win_pct = home_wins / games_played)

  # Plot winning percentage by stadium
  ggplot(home_wins, aes(x = reorder(stadium, -win_pct), y = win_pct, fill = win_pct)) +
    geom_bar(stat = "identity") +
    scale_fill_gradient(low = "red", high = "green") +
    labs(title = "Home Team Winning Percentage by Stadium",
         x = "Stadium",
         y = "Winning Percentage",
         fill = "Win %") +
    scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
```

